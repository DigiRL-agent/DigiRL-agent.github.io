<!doctype html>
<html lang="en">
    <head>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <script src="template.v2.js"></script>
        <script src="contents_bar.js"></script>
        <script src="https://d3js.org/d3.v5.min.js"></script>
        <script src="https://d3js.org/d3-collection.v1.min.js"></script>
        <script src="https://rawgit.com/nstrayer/slid3r/master/dist/slid3r.js"></script>
        <script src="cross_fade.js"></script>
        <link rel="stylesheet" href="style.css">

        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous">
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.js" integrity="sha384-9Nhn55MVVN0/4OFx7EE5kpFBPsEMZxKTCnA+4fqDmg12eCTqGi6+BB2LjY8brQxJ" crossorigin="anonymous"></script>
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"
            onload="renderMathInElement(document.body);"></script>
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
        <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>
            MathJax = {
              tex: {
                inlineMath: [['$', '$']]
              }
            };
          </script>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>RL4VLM</title>


            <style>
                /* Styling for the table */
                table, th, td {
                    border: 1px solid black;
                    border-collapse: collapse;
                }
                th, td {
                    padding: 10px;
                    text-align: left;
                    cursor: pointer;
                }
                .container {
                    display: flex;
                    align-items: start;
                }

                .table-container {
                    margin-right: 10px;
                }


                /* Styling for the carousel */
                .carousel-container {
                    width: 100%;
                    max-width: 600px;
                    margin: auto;
                    position: relative;
                    overflow: hidden;
                    align-items: center;
                    padding: 0 50px; /* Space for arrows */
                }

                .carousel-slide {
                    display: none;
                    max-width: 100%; /* Adjusted to use the full area within the padding */
                    height: auto;
                    position: relative;
                    margin: auto;
                    display: flex;
                    justify-content: center;
                    align-items: center;
                }

                .carousel-slide.active {
                    display: flex;
                }

                .carousel-slide img {
                    max-width: 100%;
                    max-height: 100%;
                    width: auto;
                    height: auto;
                    margin: 0;
                }

                .carousel-controls {
                    position: absolute;
                    top: 10px; /* Adjust this value to set how far from the top the arrows should start */
                    left: 0;
                    width: 100%;
                    display: flex;
                    justify-content: space-between;
                }

                .carousel-button {
                    position: absolute;
                    top: 75px; /* Keeps arrows at 10px from the top of the container */
                    transform: translateY(-50%); /* Center vertically relative to their height */
                    z-index: 10;
                    background: rgba(255, 255, 255, 0.8); /* Semi-transparent white background */
                    color: #000; /* Black arrow color for visibility */
                    border: none;
                    cursor: pointer;
                    font-size: 24px; /* Size of the arrow icons */
                    padding: 10px; /* Padding around the arrows */
                    height: 50px; /* Adjust this value to change the height */
                    width: 50px; /* Adjust width to maintain proportion if necessary */
                    display: flex;
                    align-items: center;
                    justify-content: center;
                }


                .carousel-button:first-child {
                    left: 0; /* Position the left arrow slightly outside the image area */
                }

                .carousel-button:last-child {
                    right: 0; /* Position the right arrow slightly outside the image area */
                }

                .carousel-caption p {
                    text-align: center;
                    font-size: 16px;
                    color: #333;
                    margin-top: 10px;
                }



                /* Additional styles can go here */
            </style>

    </head>
    <body>
        <div class="header-container">
            <div class="header-content">
              <h1>DigiRL: Training In-The-Wild Device-Control Agents with Autonomous Reinforcement Learning</h1>
              <div class="button-container">
                <a href="https://www.google.com" class="button">Paper</a>
                <a href="https://www.google.com" class="button">Code</a>
              </div>
            </div>
            <div class="header-image">
                <img src="images/teaser-head-transp.png" alt="Teaser Image" class="teaser-image">
            </div>
        </div>
    <d-article>

        <!-- Horizontal byline starts here -->
        <div class="byline-horizontal">
            <div class="authors">
                <p>
                    <a href="https://yx-s-z.github.io/" class="author-link">Author List*</a>,
                    <a href="https://www.jackgethome.com/" class="author-link">Author List*;</a>,
                    <a href="https://zipeng-lin.github.io/" class="author-link">Author List&dagger;</a>,
                    <a href="https://www.jiayipan.me/" class="author-link">Author List&dagger;</a>,
                <p>
                    <a href="https://www.alanesuhr.com/" class="author-link">Alane Suhr</a>,
                    <a href="https://people.eecs.berkeley.edu/~svlevine/" class="author-link">Sergey Levine</a>,
                    <a href="https://aviralkumar2907.github.io/" class="author-link">Aviral Kumar</a>
                </p>
            </div>
            <div class="affiliations">
                UC Berkeley, UIUC, CMU, Google DeepMind
            </div>
            <div class="contributions">
                */&dagger; Equal Contribution
            </div>
        </div>

    <script>



    var bibliography = {
        "1": "Shen, Bokui, et al. igibson 1.0: a simulation environment for interactive tasks in large realistic scenes.2021 IEEE/RSJ International Conference on Intelligent Robots and Systems (IROS). IEEE, 2021."
    };

    // Function to insert citation
    function insertCitation(refId) {
        document.getElementById("ref" + refId).innerText = "[" + refId + "]";
    }

    // Function to update bibliography section
    function updateBibliography() {
        var bibliographySection = document.getElementById('bibliography');
        for (var key in bibliography) {
            if (bibliography.hasOwnProperty(key)) {
                var para = document.createElement("p");
                para.innerHTML = "[" + key + "] " + bibliography[key];
                bibliographySection.appendChild(para);
            }
        }
    }

    let slideIndex = 0; // Global slide index

    document.addEventListener('DOMContentLoaded', (event) => {
        showSlides(slideIndex); // Initialize slides
        for (var i = 1; i <= 12; i++) {
            insertCitation(i.toString()); // Insert citations
        }
        updateBibliography(); // Update bibliography
    });

    function moveSlide(n) {
        showSlides(slideIndex += n);
    }

    function showSlides(n) {
        let i;
        let slides = document.getElementsByClassName("carousel-slide");
        if (n >= slides.length) { slideIndex = 0; }
        if (n < 0) { slideIndex = slides.length - 1; }

        for (i = 0; i < slides.length; i++) {
            slides[i].style.display = "none";
        }
        slides[slideIndex].style.display = "block"; // Display only the active slide
    }

</script>


        <d-contents>
            <nav>
                <h4>Contents</h4>
                <div><a href="#method"> Training VLMs with RL</a></div>
                <div><a href="#task"> Evaluation Tasks</a></div>
                <div><a href="#result"> Experimental Results</a></div>
            </nav>
        </d-contents>

        <d-figure>
            <img src="images/website-todos.png" width="100%">
            <figcaption>
                Website Overview.  
            </figcaption>
        </d-figure>

        <section id="result">
        <h2> 280% Performance Improvement over GPT-4V </h2>

        We show that our method can enable a backbone <a href="https://github.com/haotian-liu/LLaVA" class="code-link">LLaVA-1.6-7b</a>
        model to outperform commercial models (<a href="https://openai.com/index/gpt-4v-system-card" class="code-link">GPT4-V</a>
        and <a href="https://gemini.google.com/" class="code-link">Gemini</a>), and supervised fine-tuned LLaVA-7b.
        <d-figure>
            <img src="images/tab-imp.png" width="100%">
            <figcaption>
            Main comparisons of different agents across various settings. Each offline experiment is repeated three times and the mean and standard deviation are reported. Each online experiment is repeated two times. Results are evaluated with our autonomous evaluator with the first 96 instructions in the train and test set.
            </figcaption>
        </d-figure>

        <h3> Explore Trajectories </h3>
        <div class="carousel-container">
            <div class="carousel-slide active">
                <img src="images/nl.png" alt="Teaser Image 1">
            </div>
            <div class="carousel-slide active">
                <img src="images/ezp.png" alt="Teaser Image 2">
            </div>
            <div class="carousel-slide active">
                <img src="images/p24.png" alt="Teaser Image 3">
            </div>
            <div class="carousel-slide active">
                <img src="images/bj.png" alt="Teaser Image 4">
            </div>

            <div class="carousel-controls">
                <button class="carousel-button" onclick="moveSlide(-1)">&#10094;</button>
                <button class="carousel-button" onclick="moveSlide(1)">&#10095;</button>
            </div>
            <figcaption>
                Trajectories in ours/filtered BC/CogAgent/GPT-4V.
            </figcaption>
        </div>

        </section>

        <section id="rl-bc">
            <h2> Why RL? </h2>
            <h3> Why RL instead of filtered BC? </h3>
            The online learning curve is shown below.
        <d-figure>
            <img src="images/curves-imp.png" width="100%">
            <figcaption>
            Offline-to-online training curves for Filtered BC and DigiRL.
            Curves are smoothed with exponential weighted averaging to start from
            the performance of supervised trained policy. Two runs for each model are
            started on two different dates with at least two days apart. Observe that
            DigiRL is able to improve faster with a fewer number of samples. Since
            the data collection frequency is the bottleneck, these performance trends
            directly reflect performance trends against wall-clock time as well.
            </figcaption>
        </d-figure>

        <h3> Explore Trajectories </h3>
            <div class="carousel-container">
                <div class="carousel-slide active">
                    <img src="images/nl.png" alt="Teaser Image 1">
                </div>
                <div class="carousel-slide active">
                    <img src="images/ezp.png" alt="Teaser Image 2">
                </div>

                <div class="carousel-controls">
                    <button class="carousel-button" onclick="moveSlide(-1)">&#10094;</button>
                    <button class="carousel-button" onclick="moveSlide(1)">&#10095;</button>
                </div>
                <figcaption>
                    Trajectories in different training phase of RL and filtered BC.
                </figcaption>
            </div>
        </section>

        <section id="non-stationarity">
            <h2> Non-Stationarity </h2>
            <p>
                We show that the environment is non-stationary and dynamic, which motivates the use of RL.
            </p>
            <d-figure>
                <img src="images/non-stationarity.png" width="100%">
                <figcaption>
                    Non-stationarity and dynamism of the environment.
                </figcaption>
            </d-figure>

            <h3> Explore Trajectories </h3>
            <div class="carousel-container">
                <div class="carousel-slide active">
                    <img src="images/nl.png" alt="Teaser Image 1">
                </div>
                <div class="carousel-slide active">
                    <img src="images/ezp.png" alt="Teaser Image 2">
                </div>

                <div class="carousel-controls">
                    <button class="carousel-button" onclick="moveSlide(-1)">&#10094;</button>
                    <button class="carousel-button" onclick="moveSlide(1)">&#10095;</button>
                </div>
                <figcaption>
                    Trajectories in different training phase of RL and filtered BC.
                </figcaption>
            </div>

        </section>

        <section id="env-pressure-test">
            <h2> Scalable Emulator Parallel </h2>
            <p>
                We show that our method is scalable to a large number of machines.
            </p>

            <h3> Distributed Emulator Parallel </h3>
            <d-figure>
                <img src="images/env-distr.png" width="100%">
                <figcaption>
                Multi-machine parallel emulator execution. The host machine is equipped with GPU
                accelerators and the worker machines are equipped only with CPUs. The policy update is executed on
                the worker machine and the trajectory collections are executed distributedly on the worker machines
                and aggregated by the host machine.
                </figcaption>
            </d-figure>

            <h3> Scalability </h3>
            <d-figure>
                <img src="images/scalability.png" width="100%">
                <figcaption>
                Emulation speed w.r.t number of
                CPUs used. The upper bound can only achieved
                when there is no communication and error handling
                cost. Our design of distributed emulator can sig-
                nificantly improve the efficiency of emulation com-
                paared to the vanilla method of running all emula-
                tions over the same instance.
                </figcaption>
            </d-figure>
        </section>


        <section id="method">
            <h2>Details</h2>
            <p>

            <h3> Algorithm Framework </h3>
            
            <p>
                [Change this] We propose an algorithmic framework that directly fine-tune a large vision-language model (VLM)
                or Multimodal large language model (MLLM) using Reinforcement Learning (RL), using task rewards.

            </p>
            <d-figure>
            <img src="images/teaser.png" width="100%">
            <figcaption>
                <strong>DigiRL overview.</strong> DigiRL is built upon a VLM that
                has been pre-trained on extensive web data to develop fundamental
                skills such as common knowledge, reasoning, and visual grounding.
                Initially, we employ offline RL to fine-tune the VLM using stale
                task-specific data, which helps in eliciting goal-oriented behaviors.
                Subsequently, our agent engages with real-world graphical user
                interfaces, continuously enhancing its performance through online
                RL and autonomous performance evaluations.    
            </figcaption>
            </d-figure>

            <h3> Environment Details </h3>

            <d-figure>
                <img src="images/diagram.png" width="100%">
                <figcaption>
                    <strong>Environment details.</strong> Top: actions space and dynamics of the environment. Bottom: examples of the
                    read-world non-stationarity and dynamism of the environment.
                </figcaption>
            </d-figure>



            <h3> The DigiRL Algorithm </h3>

            [Change this] We design a $v_t^\text{in}$ in the following format, containing (1) task description; (2) legal action space;
            and (3) the desired output format $v_t^\text{out}$(containing the CoT reasoning).

            <d-figure>
                <img src="images/algo.png" alt="SEAL-Bench Results" width="100%" style="display: block; margin-left: auto; margin-right: auto;">
                <figcaption>
                    <strong>The DigiRL algorithm.</strong>
                </figcaption>
            </d-figure>

            </section>

    </section>

        </d-article>
        <d-appendix>
            <h3>BibTeX</h3>
            <p class="bibtex">
                @misc{zhai2024fine,<br>
                &nbsp;&nbsp;title={Fine-Tuning Large Vision-Language Models as Decision-Making Agents via Reinforcement Learning},<br>
                &nbsp;&nbsp;author={Zhai, Yuexiang and Bai, Hao and Lin, Zipeng and Pan, Jiayi and Tong, Shengbang and Zhou, Yifei and Suhr, Alane and Xie, Saining and LeCun, Yann and Ma, Yi and Levine, Sergey}<br>
                &nbsp;&nbsp;year={2024},<br>
                &nbsp;&nbsp;eprint={2405.10292},<br>
                &nbsp;&nbsp;archivePrefix={arXiv},<br>
                &nbsp;&nbsp;primaryClass={cs.AI}<br>
                }
            </p>
            <h3>Acknowledgment</h3>
            <p> Website template is taken from  <a href=" https://tsb0601.github.io/mmvp_blog/#mmvp" class="code-link">here</a>.
                We thank the <a href="https://hyperbolic.xyz/" class="code-link">Hyperbolic Labs</a> for the generous compute support.</p>
        </d-appendix>


        <!-- <script type="text/bibliography">

        </script> -->
        <script>

            var dContents = document.querySelector('d-contents');
            var dArticle = document.querySelector('d-article');
            // Get the computed style of the element to access the margin
            var computedStyle = window.getComputedStyle(dContents);
            // Get the top margin as an integer
            var marginTop = parseInt(computedStyle.marginTop, 10);
            // Calculate the original top offset plus the margin-top
            var originalOffsetTop = dContents.offsetTop;
            var originalOffsetLeft = dContents.offsetLeft;
            var originalWidth = dContents.offsetWidth; // This should include padding if box-sizing is border-box

            // Function to handle the resize event
            function onResize() {
                // Recalculate original left and width on resize
                originalOffsetLeft = dContents.offsetLeft;
                originalWidth = dContents.offsetWidth; // This should include padding if box-sizing is border-box
            }

            // Add the resize event listener
            window.addEventListener('resize', onResize);

            window.addEventListener('scroll', function() {
                var scrollPosition = window.pageYOffset || document.documentElement.scrollTop;
                var dArticleBottom = dArticle.offsetTop + dArticle.offsetHeight;
                var dContentsActualTop = scrollPosition > originalOffsetTop ? scrollPosition : originalOffsetTop;
                var dContentsBottom = dContentsActualTop + dContents.offsetHeight;
                console.log("dArticleBottom", dArticleBottom)
                console.log("dContentsBottom", dContentsBottom)
                if (dContentsBottom >= dArticleBottom) {
                    // Make d-contents invisible
                    dContents.style.visibility = 'hidden';
                } else {
                    // Make d-contents visible
                    dContents.style.visibility = 'visible';
                }

                // Adjust the condition to account for margin-top
                if (scrollPosition + marginTop >= originalOffsetTop) {
                    dContents.style.position = 'fixed';
                    dContents.style.top = '0px';
                    dContents.style.left = originalOffsetLeft + 'px'; // Maintain the original horizontal position
                    dContents.style.width = originalWidth + 'px'; // Maintain the original width
                } else {
                    dContents.style.position = '';
                    dContents.style.top = '';
                    dContents.style.left = '';
                    dContents.style.width = ''; // Allow the width to be automatic
                }


            });



            // Initialize width and position
            onResize();
        </script>

        <script>
            // Function to determine which section is in view
            function getActiveSection() {
                var sections = document.querySelectorAll('section'); // Assuming your sections have a 'section' tag
                var scrollPosition = window.pageYOffset || document.documentElement.scrollTop;

                for (var i = 0; i < sections.length; i++) {
                    if (sections[i].offsetTop <= scrollPosition && sections[i].offsetTop + sections[i].offsetHeight > scrollPosition) {
                        return sections[i].id;
                    }
                }
                return null;
            }

            // Function to update the navigation items
            function updateNavigation() {
                var activeSection = getActiveSection();
                var navLinks = document.querySelectorAll('d-contents nav a');

                navLinks.forEach(function(navLink) {
                    if (navLink.getAttribute('href') === '#' + activeSection) {
                        navLink.classList.add('active-nav-item');
                    } else {
                        navLink.classList.remove('active-nav-item');
                    }
                });
            }

            // Add the scroll event listener
            window.addEventListener('scroll', updateNavigation);

            // Initial update
            updateNavigation();

            // Insert citations and update bibliography on page load
        </script>
    </body>
</html>
